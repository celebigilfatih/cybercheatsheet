import fs from 'fs'
import path from 'path'
import { fileURLToPath } from 'url'

const __filename = fileURLToPath(import.meta.url)
const __dirname = path.dirname(__filename)

const mdbPath = path.join(__dirname, '..', 'mdb')
const dataPath = path.join(__dirname, '..', 'data')

// Load base data
const baseData = JSON.parse(fs.readFileSync(path.join(dataPath, 'kali-tools.json'), 'utf-8'))

// Additional tools that should be in the database
const additionalTools = [
  {
    "title": {
      "tr": "Dirb Cheatsheet",
      "en": "Dirb Cheatsheet"
    },
    "description": {
      "tr": "# Dirb - Web Content Scanner\n\n## Temel Kullanım\n\n**Basit tarama (default wordlist):**\n```\ndirb http://target.com\n```\n\n**Özel wordlist ile:**\n```\ndirb http://target.com /usr/share/dirb/wordlists/common.txt\n```\n\n**HTTPS tarama:**\n```\ndirb https://target.com\n```\n\n**Belirli port:**\n```\ndirb http://target.com:8080\n```\n\n## İleri Seviye Kullanım\n\n### Proxy Kullanımı\n\n**HTTP proxy:**\n```\ndirb http://target.com -p http://127.0.0.1:8080\n```\n\n**SOCKS proxy:**\n```\ndirb http://target.com -p socks://127.0.0.1:9050\n```\n\n**Burp Suite üzerinden:**\n```\ndirb https://target.com -p http://127.0.0.1:8080\n```\n\n### Authentication\n\n**HTTP Basic Auth:**\n```\ndirb http://target.com -u username:password\n```\n\n**Custom header ekleme:**\n```\ndirb http://target.com -H \"Authorization: Bearer TOKEN\"\n```\n\n**Multiple header:**\n```\ndirb http://target.com -H \"Authorization: Bearer TOKEN\" -H \"X-Custom: value\"\n```\n\n### Cookie Kullanımı\n\n**Cookie ile tarama:**\n```\ndirb http://target.com -c \"PHPSESSID=abc123; role=admin\"\n```\n\n**Session tabanlı tarama:**\n```\ndirb http://target.com -c \"SESSION=xyz789\"\n```\n\n### User-Agent Değiştirme\n\n**Custom user-agent:**\n```\ndirb http://target.com -a \"Mozilla/5.0 (Windows NT 10.0; Win64; x64)\"\n```\n\n**Mobile user-agent:**\n```\ndirb http://target.com -a \"Mozilla/5.0 (iPhone; CPU iPhone OS 14_0)\"\n```\n\n### Extension Brute-forcing\n\n**Extension listesi:**\n```\ndirb http://target.com -X .php,.txt,.html,.jsp,.asp\n```\n\n**Büyük harf extension:**\n```\ndirb http://target.com -X .PHP,.Php,.pHp\n```\n\n### Recursion & Depth\n\n**Non-recursive (sadece root):**\n```\ndirb http://target.com -r\n```\n\n**Recursive tarama (default):**\n```\ndirb http://target.com\n```\n\n### Rate-Limit / WAF Bypass\n\n**Delay ekleme (milliseconds):**\n```\ndirb http://target.com -z 1000\n```\n\n**Yavaş tarama (WAF bypass):**\n```\ndirb http://target.com -z 2000 -a \"GoogleBot/2.1\"\n```\n\n**Timeout ayarı:**\n```\ndirb http://target.com -t\n```\n\n### Output Kaydetme\n\n**Sonuçları kaydet:**\n```\ndirb http://target.com -o results.txt\n```\n\n**HTML format:**\n```\ndirb http://target.com -o results.html\n```\n\n**Sessiz mod + output:**\n```\ndirb http://target.com -S -o results.txt\n```\n\n### Custom Wordlist\n\n**Kendi wordlist'iniz:**\n```\ndirb http://target.com /path/to/custom-wordlist.txt\n```\n\n**Multiple wordlist (sırayla):**\n```\ndirb http://target.com /usr/share/dirb/wordlists/big.txt\ndirb http://target.com /usr/share/dirb/wordlists/common.txt\n```\n\n\n## Argument Referansı\n\n### Temel Argümanlar\n\n**`-a <user-agent>`**\n*User-Agent string'ini özelleştir.*\n```\ndirb http://target.com -a \"Mozilla/5.0...\"\n```\n\n**`-c <cookie>`**\n*HTTP Cookie gönder.*\n```\ndirb http://target.com -c \"PHPSESSID=abc123\"\n```\n\n**`-f`**\n*Fine-tuning: Her dizin için trailing slash (/) ile ve olmadan dene.*\n```\ndirb http://target.com -f\n```\n\n**`-H <header>`**\n*Custom HTTP header ekle (multiple kullanılabilir).*\n```\ndirb http://target.com -H \"Authorization: Bearer TOKEN\"\n```\n\n**`-i`**\n*Case-insensitive mod (büyük/küçük harf duyarsız).*\n```\ndirb http://target.com -i\n```\n\n**`-l`**\n*Location header'ları da yazdır.*\n```\ndirb http://target.com -l\n```\n\n**`-N <status_code>`**\n*Belirtilen HTTP status code'u gösterme.*\n```\ndirb http://target.com -N 404\n```\n\n**`-o <output_file>`**\n*Sonuçları dosyaya kaydet.*\n```\ndirb http://target.com -o results.txt\n```\n\n**`-p <proxy[:port]>`**\n*Proxy server kullan (HTTP veya SOCKS).*\n```\ndirb http://target.com -p http://127.0.0.1:8080\n```\n\n**`-r`**\n*Non-recursive mod (alt dizinlere girme).*\n```\ndirb http://target.com -r\n```\n\n**`-R`**\n*Interactive recursion (her dizin için sor).*\n```\ndirb http://target.com -R\n```\n\n**`-S`**\n*Silent mode (banner/başlık gösterme).*\n```\ndirb http://target.com -S\n```\n\n**`-t`**\n*Timeout'u etkinleştir (connect/read timeout).*\n```\ndirb http://target.com -t\n```\n\n**`-u <username:password>`**\n*HTTP Basic Authentication.*\n```\ndirb http://target.com -u admin:pass123\n```\n\n**`-v`**\n*Verbose output (tüm response'ları göster).*\n```\ndirb http://target.com -v\n```\n\n**`-w`**\n*Warning mesajlarını gösterme.*\n```\ndirb http://target.com -w\n```\n\n**`-X <extensions>`**\n*Extension listesi ekle (virgülle ayır).*\n```\ndirb http://target.com -X .php,.txt,.html\n```\n\n**`-z <milliseconds>`**\n*Her istek arasına delay ekle (milliseconds).*\n```\ndirb http://target.com -z 1000\n```\n\n### Argüman Kombinasyonları\n\n**Stealth tarama:**\n```\ndirb http://target.com -z 2000 -a \"Googlebot\" -S -o stealth.txt\n```\n*-z: 2 saniye delay, -a: Bot UA, -S: Sessiz, -o: Kaydet*\n\n**Authenticated tarama:**\n```\ndirb http://target.com -u admin:pass -c \"session=xyz\" -H \"X-CSRF-Token: abc\"\n```\n*-u: Basic Auth, -c: Cookie, -H: Custom header*\n\n**Proxy + Extension:**\n```\ndirb http://target.com -p http://127.0.0.1:8080 -X .php,.bak -f\n```\n*-p: Burp proxy, -X: Extensions, -f: Trailing slash test*\n\n**Fast & Quiet:**\n```\ndirb http://target.com -S -w -N 404 -o quick-scan.txt\n```\n*-S: Silent, -w: No warnings, -N: Ignore 404, -o: Save*\n\n## Açıklamalı Komutlar\n\n**Sessiz mod (banner gizle):**\n```\ndirb http://target.com -S\n```\n*Output'u temiz tutar, banner/bilgi göstermez.*\n\n**Belirli status code gösterme:**\n```\ndirb http://target.com -N 404\n```\n*404 dönen sonuçları göstermez.*\n\n**Case-insensitive tarama:**\n```\ndirb http://target.com -i\n```\n*admin, Admin, ADMIN aynı kabul edilir.*\n\n**Fine-tuning:**\n```\ndirb http://target.com -f\n```\n*Her dizin için '/' ile ve '/' olmadan dener.*\n\n**Ignore eşleşen kelimeler:**\n```\ndirb http://target.com -v\n```\n*Location header'daki redirect'leri gösterir.*\n\n**Speed mode (hızlı tarama):**\n```\ndirb http://target.com -w\n```\n*Warning mesajları göstermez, daha hızlı.*\n\n**Tüm response göster:**\n```\ndirb http://target.com -l\n```\n*Tüm yanıtları detaylı gösterir (debug için).*\n\n## Gerçek Pentest Senaryoları\n\n### Senaryo 1: WAF Arkasında Dizin Bulma\n\n```\ndirb https://target.com /usr/share/dirb/wordlists/common.txt \\\n  -z 2000 \\\n  -a \"Mozilla/5.0 (compatible; Googlebot/2.1)\" \\\n  -H \"X-Forwarded-For: 127.0.0.1\" \\\n  -o waf-bypass-results.txt\n```\n*2 saniye delay, GoogleBot UA, IP spoofing.*\n\n### Senaryo 2: Auth Zorunlu Dizinler\n\n```\ndirb https://target.com/admin \\\n  -c \"PHPSESSID=valid_session_token; role=admin\" \\\n  -H \"Authorization: Bearer eyJhbGc...\" \\\n  -X .php,.inc,.conf\n```\n*Cookie + JWT token ile authenticated tarama.*\n\n### Senaryo 3: Proxy Üzerinden Tarama (Burp)\n\n```\ndirb https://target.com \\\n  -p http://127.0.0.1:8080 \\\n  -c \"session=abc123\" \\\n  /usr/share/dirb/wordlists/big.txt \\\n  -o burp-scan.txt\n```\n*Tüm trafik Burp'ten geçer, manuel analiz için.*\n\n### Senaryo 4: Büyük Wordlist + Multi-Extension\n\n```\ndirb http://target.com \\\n  /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt \\\n  -X .php,.bak,.old,.txt,.inc,.zip,.sql \\\n  -z 500 \\\n  -S \\\n  -o massive-scan.txt\n```\n*220k+ kelime, 7 extension, sessiz mod.*\n\n### Senaryo 5: API Endpoint Discovery\n\n```\ndirb https://api.target.com/v1 \\\n  /usr/share/dirb/wordlists/common.txt \\\n  -H \"Content-Type: application/json\" \\\n  -H \"X-API-Key: your_key\" \\\n  -X .json\n```\n*API-specific tarama.*\n\n### Senaryo 6: Backup File Hunting\n\n```\ndirb http://target.com \\\n  /usr/share/dirb/wordlists/common.txt \\\n  -X .bak,.old,.backup,.swp,.save,.1,.orig\n```\n*Backup dosya avcılığı.*\n\n## Best Practices\n\n**1. Wordlist seçimi:**\n- Başlangıç: `common.txt` (4600 kelime)\n- Orta: `big.txt` (20k kelime)\n- Agresif: `directory-list-2.3-big.txt` (220k kelime)\n\n**2. Extension stratejisi:**\n- Backend tespiti yap (PHP, ASP, JSP)\n- İlgili extension'ları hedefle\n- .bak, .old, .zip ekle\n\n**3. Rate limiting:**\n- WAF varsa `-z 1000` ile başla\n- Engellenme yoksa hızlandır\n- Başarılı istek sonrası delay azalt\n\n**4. Proxy kullanımı:**\n- Her zaman Burp/ZAP ile tara\n- Manuel doğrulama için\n- False-positive tespiti\n\n**5. Cookie/Auth:**\n- Authenticated dizinler için gerekli\n- Session expire kontrolü\n- Multi-role test (user, admin, moderator)\n\n**6. Recursion:**\n- İlk tarama non-recursive `-r`\n- İlginç dizinler için recursive\n- Sonsuz döngü riski (symlink)\n\n**7. Output yönetimi:**\n- Her zaman `-o` ile kaydet\n- Timestamp ekle filename'e\n- Büyük taramalar için `-S` (silent)\n\n## Sık Yapılan Hatalar\n\n**1. Delay kullanmama:**\n```\n# YANLIŞ\ndirb https://waf-protected.com\n\n# DOĞRU\ndirb https://waf-protected.com -z 1500\n```\n*WAF/IDS tarafından engellenir.*\n\n**2. Extension eksikliği:**\n```\n# YANLIŞ\ndirb http://target.com\n\n# DOĞRU\ndirb http://target.com -X .php,.inc,.bak\n```\n*Önemli dosyaları kaçırırsın.*\n\n**3. 404 kontrolü yapmama:**\n```\n# Test et\ncurl -I http://target.com/nonexistentfile12345\n```\n*Bazı serverlar her şey için 200 döner (wildcard).*\n\n**4. Proxy olmadan tarama:**\n```\n# YANLIŞ\ndirb https://target.com\n\n# DOĞRU\ndirb https://target.com -p http://127.0.0.1:8080\n```\n*Manuel analiz/exploit imkanı kaçar.*\n\n**5. Recursive bombing:**\n```\n# YANLIŞ (symlink loop varsa)\ndirb http://target.com /huge-wordlist.txt\n\n# DOĞRU\ndirb http://target.com -r /huge-wordlist.txt\n```\n*İlk tarama non-recursive yap.*\n\n**6. Wordlist seçimi:**\n```\n# YANLIŞ (gereksiz büyük)\ndirb http://small-site.com /usr/share/seclists/.../raft-large.txt\n\n# DOĞRU (kademeli)\ndirb http://small-site.com /usr/share/dirb/wordlists/common.txt\n```\n*Küçük hedefler için küçük wordlist.*\n\n**7. User-Agent değiştirmeme:**\n```\n# YANLIŞ\ndirb http://target.com\n\n# DOĞRU (WAF bypass)\ndirb http://target.com -a \"Mozilla/5.0...\"\n```\n*Default UA engellenebilir.*\n\n**8. Output kaydetmeme:**\n```\n# YANLIŞ\ndirb http://target.com /huge-wordlist.txt\n\n# DOĞRU\ndirb http://target.com /huge-wordlist.txt -o scan_$(date +%Y%m%d_%H%M).txt\n```\n*Terminal kapanırsa tüm sonuçlar kaybolur.*\n\n## Wordlist Konumları\n\n```\n/usr/share/dirb/wordlists/common.txt          # 4600 entries\n/usr/share/dirb/wordlists/big.txt             # 20k entries\n/usr/share/dirb/wordlists/small.txt           # 980 entries\n/usr/share/dirb/wordlists/extensions_common.txt\n/usr/share/seclists/Discovery/Web-Content/    # SecLists\n```\n\n## İpuçları\n\n- SSL hatası: Dirb SSL cert doğrulaması yapmaz (avantaj)\n- Wildcard detection: İlk 10 istekte pattern arar\n- Case-sensitive: `-i` flag'i kullan\n- Speed vs Stealth: `-z` değerini dengele\n- False-positive: Proxy'den manuel kontrol et\n- Multi-stage: common.txt → bulduklarını recursive tara\n",
      "en": "# Dirb - Web Content Scanner\n\n## Temel Kullanım\n\n**Basit tarama (default wordlist):**\n```\ndirb http://target.com\n```\n\n**Özel wordlist ile:**\n```\ndirb http://target.com /usr/share/dirb/wordlists/common.txt\n```\n\n**HTTPS tarama:**\n```\ndirb https://target.com\n```\n\n**Belirli port:**\n```\ndirb http://target.com:8080\n```\n\n## İleri Seviye Kullanım\n\n### Proxy Kullanımı\n\n**HTTP proxy:**\n```\ndirb http://target.com -p http://127.0.0.1:8080\n```\n\n**SOCKS proxy:**\n```\ndirb http://target.com -p socks://127.0.0.1:9050\n```\n\n**Burp Suite üzerinden:**\n```\ndirb https://target.com -p http://127.0.0.1:8080\n```\n\n### Authentication\n\n**HTTP Basic Auth:**\n```\ndirb http://target.com -u username:password\n```\n\n**Custom header ekleme:**\n```\ndirb http://target.com -H \"Authorization: Bearer TOKEN\"\n```\n\n**Multiple header:**\n```\ndirb http://target.com -H \"Authorization: Bearer TOKEN\" -H \"X-Custom: value\"\n```\n\n### Cookie Kullanımı\n\n**Cookie ile tarama:**\n```\ndirb http://target.com -c \"PHPSESSID=abc123; role=admin\"\n```\n\n**Session tabanlı tarama:**\n```\ndirb http://target.com -c \"SESSION=xyz789\"\n```\n\n### User-Agent Değiştirme\n\n**Custom user-agent:**\n```\ndirb http://target.com -a \"Mozilla/5.0 (Windows NT 10.0; Win64; x64)\"\n```\n\n**Mobile user-agent:**\n```\ndirb http://target.com -a \"Mozilla/5.0 (iPhone; CPU iPhone OS 14_0)\"\n```\n\n### Extension Brute-forcing\n\n**Extension listesi:**\n```\ndirb http://target.com -X .php,.txt,.html,.jsp,.asp\n```\n\n**Büyük harf extension:**\n```\ndirb http://target.com -X .PHP,.Php,.pHp\n```\n\n### Recursion & Depth\n\n**Non-recursive (sadece root):**\n```\ndirb http://target.com -r\n```\n\n**Recursive tarama (default):**\n```\ndirb http://target.com\n```\n\n### Rate-Limit / WAF Bypass\n\n**Delay ekleme (milliseconds):**\n```\ndirb http://target.com -z 1000\n```\n\n**Yavaş tarama (WAF bypass):**\n```\ndirb http://target.com -z 2000 -a \"GoogleBot/2.1\"\n```\n\n**Timeout ayarı:**\n```\ndirb http://target.com -t\n```\n\n### Output Kaydetme\n\n**Sonuçları kaydet:**\n```\ndirb http://target.com -o results.txt\n```\n\n**HTML format:**\n```\ndirb http://target.com -o results.html\n```\n\n**Sessiz mod + output:**\n```\ndirb http://target.com -S -o results.txt\n```\n\n### Custom Wordlist\n\n**Kendi wordlist'iniz:**\n```\ndirb http://target.com /path/to/custom-wordlist.txt\n```\n\n**Multiple wordlist (sırayla):**\n```\ndirb http://target.com /usr/share/dirb/wordlists/big.txt\ndirb http://target.com /usr/share/dirb/wordlists/common.txt\n```\n\n\n## Argument Referansı\n\n### Temel Argümanlar\n\n**`-a <user-agent>`**\n*User-Agent string'ini özelleştir.*\n```\ndirb http://target.com -a \"Mozilla/5.0...\"\n```\n\n**`-c <cookie>`**\n*HTTP Cookie gönder.*\n```\ndirb http://target.com -c \"PHPSESSID=abc123\"\n```\n\n**`-f`**\n*Fine-tuning: Her dizin için trailing slash (/) ile ve olmadan dene.*\n```\ndirb http://target.com -f\n```\n\n**`-H <header>`**\n*Custom HTTP header ekle (multiple kullanılabilir).*\n```\ndirb http://target.com -H \"Authorization: Bearer TOKEN\"\n```\n\n**`-i`**\n*Case-insensitive mod (büyük/küçük harf duyarsız).*\n```\ndirb http://target.com -i\n```\n\n**`-l`**\n*Location header'ları da yazdır.*\n```\ndirb http://target.com -l\n```\n\n**`-N <status_code>`**\n*Belirtilen HTTP status code'u gösterme.*\n```\ndirb http://target.com -N 404\n```\n\n**`-o <output_file>`**\n*Sonuçları dosyaya kaydet.*\n```\ndirb http://target.com -o results.txt\n```\n\n**`-p <proxy[:port]>`**\n*Proxy server kullan (HTTP veya SOCKS).*\n```\ndirb http://target.com -p http://127.0.0.1:8080\n```\n\n**`-r`**\n*Non-recursive mod (alt dizinlere girme).*\n```\ndirb http://target.com -r\n```\n\n**`-R`**\n*Interactive recursion (her dizin için sor).*\n```\ndirb http://target.com -R\n```\n\n**`-S`**\n*Silent mode (banner/başlık gösterme).*\n```\ndirb http://target.com -S\n```\n\n**`-t`**\n*Timeout'u etkinleştir (connect/read timeout).*\n```\ndirb http://target.com -t\n```\n\n**`-u <username:password>`**\n*HTTP Basic Authentication.*\n```\ndirb http://target.com -u admin:pass123\n```\n\n**`-v`**\n*Verbose output (tüm response'ları göster).*\n```\ndirb http://target.com -v\n```\n\n**`-w`**\n*Warning mesajlarını gösterme.*\n```\ndirb http://target.com -w\n```\n\n**`-X <extensions>`**\n*Extension listesi ekle (virgülle ayır).*\n```\ndirb http://target.com -X .php,.txt,.html\n```\n\n**`-z <milliseconds>`**\n*Her istek arasına delay ekle (milliseconds).*\n```\ndirb http://target.com -z 1000\n```\n\n### Argüman Kombinasyonları\n\n**Stealth tarama:**\n```\ndirb http://target.com -z 2000 -a \"Googlebot\" -S -o stealth.txt\n```\n*-z: 2 saniye delay, -a: Bot UA, -S: Sessiz, -o: Kaydet*\n\n**Authenticated tarama:**\n```\ndirb http://target.com -u admin:pass -c \"session=xyz\" -H \"X-CSRF-Token: abc\"\n```\n*-u: Basic Auth, -c: Cookie, -H: Custom header*\n\n**Proxy + Extension:**\n```\ndirb http://target.com -p http://127.0.0.1:8080 -X .php,.bak -f\n```\n*-p: Burp proxy, -X: Extensions, -f: Trailing slash test*\n\n**Fast & Quiet:**\n```\ndirb http://target.com -S -w -N 404 -o quick-scan.txt\n```\n*-S: Silent, -w: No warnings, -N: Ignore 404, -o: Save*\n\n## Açıklamalı Komutlar\n\n**Sessiz mod (banner gizle):**\n```\ndirb http://target.com -S\n```\n*Output'u temiz tutar, banner/bilgi göstermez.*\n\n**Belirli status code gösterme:**\n```\ndirb http://target.com -N 404\n```\n*404 dönen sonuçları göstermez.*\n\n**Case-insensitive tarama:**\n```\ndirb http://target.com -i\n```\n*admin, Admin, ADMIN aynı kabul edilir.*\n\n**Fine-tuning:**\n```\ndirb http://target.com -f\n```\n*Her dizin için '/' ile ve '/' olmadan dener.*\n\n**Ignore eşleşen kelimeler:**\n```\ndirb http://target.com -v\n```\n*Location header'daki redirect'leri gösterir.*\n\n**Speed mode (hızlı tarama):**\n```\ndirb http://target.com -w\n```\n*Warning mesajları göstermez, daha hızlı.*\n\n**Tüm response göster:**\n```\ndirb http://target.com -l\n```\n*Tüm yanıtları detaylı gösterir (debug için).*\n\n## Gerçek Pentest Senaryoları\n\n### Senaryo 1: WAF Arkasında Dizin Bulma\n\n```\ndirb https://target.com /usr/share/dirb/wordlists/common.txt \\\n  -z 2000 \\\n  -a \"Mozilla/5.0 (compatible; Googlebot/2.1)\" \\\n  -H \"X-Forwarded-For: 127.0.0.1\" \\\n  -o waf-bypass-results.txt\n```\n*2 saniye delay, GoogleBot UA, IP spoofing.*\n\n### Senaryo 2: Auth Zorunlu Dizinler\n\n```\ndirb https://target.com/admin \\\n  -c \"PHPSESSID=valid_session_token; role=admin\" \\\n  -H \"Authorization: Bearer eyJhbGc...\" \\\n  -X .php,.inc,.conf\n```\n*Cookie + JWT token ile authenticated tarama.*\n\n### Senaryo 3: Proxy Üzerinden Tarama (Burp)\n\n```\ndirb https://target.com \\\n  -p http://127.0.0.1:8080 \\\n  -c \"session=abc123\" \\\n  /usr/share/dirb/wordlists/big.txt \\\n  -o burp-scan.txt\n```\n*Tüm trafik Burp'ten geçer, manuel analiz için.*\n\n### Senaryo 4: Büyük Wordlist + Multi-Extension\n\n```\ndirb http://target.com \\\n  /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt \\\n  -X .php,.bak,.old,.txt,.inc,.zip,.sql \\\n  -z 500 \\\n  -S \\\n  -o massive-scan.txt\n```\n*220k+ kelime, 7 extension, sessiz mod.*\n\n### Senaryo 5: API Endpoint Discovery\n\n```\ndirb https://api.target.com/v1 \\\n  /usr/share/dirb/wordlists/common.txt \\\n  -H \"Content-Type: application/json\" \\\n  -H \"X-API-Key: your_key\" \\\n  -X .json\n```\n*API-specific tarama.*\n\n### Senaryo 6: Backup File Hunting\n\n```\ndirb http://target.com \\\n  /usr/share/dirb/wordlists/common.txt \\\n  -X .bak,.old,.backup,.swp,.save,.1,.orig\n```\n*Backup dosya avcılığı.*\n\n## Best Practices\n\n**1. Wordlist seçimi:**\n- Başlangıç: `common.txt` (4600 kelime)\n- Orta: `big.txt` (20k kelime)\n- Agresif: `directory-list-2.3-big.txt` (220k kelime)\n\n**2. Extension stratejisi:**\n- Backend tespiti yap (PHP, ASP, JSP)\n- İlgili extension'ları hedefle\n- .bak, .old, .zip ekle\n\n**3. Rate limiting:**\n- WAF varsa `-z 1000` ile başla\n- Engellenme yoksa hızlandır\n- Başarılı istek sonrası delay azalt\n\n**4. Proxy kullanımı:**\n- Her zaman Burp/ZAP ile tara\n- Manuel doğrulama için\n- False-positive tespiti\n\n**5. Cookie/Auth:**\n- Authenticated dizinler için gerekli\n- Session expire kontrolü\n- Multi-role test (user, admin, moderator)\n\n**6. Recursion:**\n- İlk tarama non-recursive `-r`\n- İlginç dizinler için recursive\n- Sonsuz döngü riski (symlink)\n\n**7. Output yönetimi:**\n- Her zaman `-o` ile kaydet\n- Timestamp ekle filename'e\n- Büyük taramalar için `-S` (silent)\n\n## Sık Yapılan Hatalar\n\n**1. Delay kullanmama:**\n```\n# YANLIŞ\ndirb https://waf-protected.com\n\n# DOĞRU\ndirb https://waf-protected.com -z 1500\n```\n*WAF/IDS tarafından engellenir.*\n\n**2. Extension eksikliği:**\n```\n# YANLIŞ\ndirb http://target.com\n\n# DOĞRU\ndirb http://target.com -X .php,.inc,.bak\n```\n*Önemli dosyaları kaçırırsın.*\n\n**3. 404 kontrolü yapmama:**\n```\n# Test et\ncurl -I http://target.com/nonexistentfile12345\n```\n*Bazı serverlar her şey için 200 döner (wildcard).*\n\n**4. Proxy olmadan tarama:**\n```\n# YANLIŞ\ndirb https://target.com\n\n# DOĞRU\ndirb https://target.com -p http://127.0.0.1:8080\n```\n*Manuel analiz/exploit imkanı kaçar.*\n\n**5. Recursive bombing:**\n```\n# YANLIŞ (symlink loop varsa)\ndirb http://target.com /huge-wordlist.txt\n\n# DOĞRU\ndirb http://target.com -r /huge-wordlist.txt\n```\n*İlk tarama non-recursive yap.*\n\n**6. Wordlist seçimi:**\n```\n# YANLIŞ (gereksiz büyük)\ndirb http://small-site.com /usr/share/seclists/.../raft-large.txt\n\n# DOĞRU (kademeli)\ndirb http://small-site.com /usr/share/dirb/wordlists/common.txt\n```\n*Küçük hedefler için küçük wordlist.*\n\n**7. User-Agent değiştirmeme:**\n```\n# YANLIŞ\ndirb http://target.com\n\n# DOĞRU (WAF bypass)\ndirb http://target.com -a \"Mozilla/5.0...\"\n```\n*Default UA engellenebilir.*\n\n**8. Output kaydetmeme:**\n```\n# YANLIŞ\ndirb http://target.com /huge-wordlist.txt\n\n# DOĞRU\ndirb http://target.com /huge-wordlist.txt -o scan_$(date +%Y%m%d_%H%M).txt\n```\n*Terminal kapanırsa tüm sonuçlar kaybolur.*\n\n## Wordlist Konumları\n\n```\n/usr/share/dirb/wordlists/common.txt          # 4600 entries\n/usr/share/dirb/wordlists/big.txt             # 20k entries\n/usr/share/dirb/wordlists/small.txt           # 980 entries\n/usr/share/dirb/wordlists/extensions_common.txt\n/usr/share/seclists/Discovery/Web-Content/    # SecLists\n```\n\n## İpuçları\n\n- SSL hatası: Dirb SSL cert doğrulaması yapmaz (avantaj)\n- Wildcard detection: İlk 10 istekte pattern arar\n- Case-sensitive: `-i` flag'i kullan\n- Speed vs Stealth: `-z` değerini dengele\n- False-positive: Proxy'den manuel kontrol et\n- Multi-stage: common.txt → bulduklarını recursive tara\n"
    },
    "tags": [
      "dirb",
      "bruteforce",
      "directories",
      "web-scanner",
      "pentest"
    ],
    "links": [
      "https://tools.kali.org/web-applications/dirb",
      "http://dirb.sourceforge.net/"
    ],
    "category": { "$oid": "6915e1cc2ee79a06a3d4bc47" }
  },
  {
    "title": {
      "tr": "Wireshark Cheatsheet",
      "en": "Wireshark Cheatsheet"
    },
    "description": {
      "tr": "# Wireshark - Network Protocol Analyzer\n\n## 1. Açıklama\nWireshark, ağ protokollerini gerçek zamanlı olarak yakalayan ve analiz eden açık kaynaklı bir ağ protokolü analizörüdür. Grafiksel arayüzü ile kullanıcı dostu bir şekilde ağ trafiğini incelemeye olanak tanır.\n\n## 2. Temel Kullanım\n\n### Paket Yakalama\n\n**Belirli bir arabirimden paket yakalama:**\n```\nwireshark -i eth0\n```\n\n**Tüm arabirimlerden paket yakalama:**\n```\nwireshark -i any\n```\n\n**Belirli sayıda paket yakalama:**\n```\nwireshark -i eth0 -c 100\n```\n\n**Paketleri dosyaya kaydetme:**\n```\nwireshark -i eth0 -w capture.pcap\n```\n\n**Önceden kaydedilmiş dosyayı açma:**\n```\nwireshark capture.pcap\n```\n\n## 3. Display Filters (Gösterim Filtreleri)\n\n### Temel Filtreler\n\n**Belirli bir IP adresi:**\n```\nip.addr == 192.168.1.100\n```\n\n**Kaynak IP:**\n```\nip.src == 192.168.1.100\n```\n\n**Hedef IP:**\n```\nip.dst == 192.168.1.100\n```\n\n**Belirli bir port:**\n```\ntcp.port == 80\n```\n\n**Kaynak port:**\n```\ntcp.srcport == 80\n```\n\n**Hedef port:**\n```\ntcp.dstport == 80\n```\n\n**Belirli bir protokol:**\n```\nhttp\n```\n\n**Belirli bir MAC adresi:**\n```\neth.addr == 00:11:22:33:44:55\n```\n\n### İleri Seviye Filtreler\n\n**HTTP GET istekleri:**\n```\nhttp.request.method == \"GET\"\n```\n\n**HTTP POST istekleri:**\n```\nhttp.request.method == \"POST\"\n```\n\n**Belirli bir URL:**\n```\nhttp.host == \"example.com\"\n```\n\n**DNS sorguları:**\n```\ndns\n```\n\n**ARP istekleri:**\n```\narp.opcode == 1\n```\n\n**TCP SYN paketleri:**\n```\ntcp.flags.syn == 1\n```\n\n**TCP RST paketleri:**\n```\ntcp.flags.reset == 1\n```\n\n**ICMP paketleri:**\n```\nicmp\n```\n\n**Belirli bir boyuttaki paketler:**\n```\nframe.len > 1000\n```\n\n## 4. Capture Filters (Yakalama Filtreleri)\n\n### Temel Yakalama Filtreleri\n\n**Belirli bir IP adresinden gelen paketler:**\n```\nwireshark -i eth0 host 192.168.1.100\n```\n\n**Belirli bir ağdan gelen paketler:**\n```\nwireshark -i eth0 net 192.168.1.0/24\n```\n\n**Belirli bir porttaki paketler:**\n```\nwireshark -i eth0 port 80\n```\n\n**Belirli bir protokoldeki paketler:**\n```\nwireshark -i eth0 tcp\n```\n\n**Belirli bir port aralığındaki paketler:**\n```\nwireshark -i eth0 portrange 80-100\n```\n\n**Belirli bir yöndeki paketler:**\n```\nwireshark -i eth0 src host 192.168.1.100\nwireshark -i eth0 dst host 192.168.1.100\n```\n\n## 5. İstatistiksel Analiz\n\n### Conversations (Konuşmalar)\n- **Statistics > Conversations** menüsünden erişilir\n- IP, TCP, UDP gibi protokoller arası iletişimleri gösterir\n- Gönderilen/alınan byte miktarlarını gösterir\n\n### Protocol Hierarchy (Protokol Hiyerarşisi)\n- **Statistics > Protocol Hierarchy** menüsünden erişilir\n- Hangi protokollerin ne kadar kullanıldığını gösterir\n- Protokol bazlı trafik analizi yapar\n\n### Flow Graph (Akış Grafiği)\n- **Statistics > Flow Graph** menüsünden erişilir\n- TCP bağlantısının kurulumunu ve akışını gösterir\n- 3-way handshake ve veri akışını görselleştirir\n\n## 6. Gerçek Zamanlı Analiz\n\n### Follow TCP Stream\n- Bir TCP akışını takip etmek için kullanılır\n- Sağ tık > Follow > TCP Stream\n- HTTP istek/cevaplarını tam olarak görmenizi sağlar\n\n### Expert Info (Uzman Bilgisi)\n- **Analyze > Expert Info** menüsünden erişilir\n- Anormal ağ davranışlarını gösterir\n- Hata, uyarı ve bilgi mesajlarını listeler\n\n## 7. Command Line Kullanımı\n\n### tshark (Terminal tabanlı Wireshark)\n\n**Temel kullanım:**\n```\ntshark -i eth0\n```\n\n**Belirli bir filtre ile:**\n```\ntshark -i eth0 -f \"tcp port 80\"\n```\n\n**Display filtresi ile:**\n```\ntshark -i eth0 -R \"http.request.method == GET\"\n```\n\n**Paketleri dosyaya yazma:**\n```\ntshark -i eth0 -w capture.pcap\n```\n\n**Dosyadan okuma:**\n```\ntshark -r capture.pcap\n```\n\n**Belirli alanları çıkarma:**\n```\ntshark -r capture.pcap -T fields -e ip.src -e ip.dst -e tcp.srcport -e tcp.dstport\n```\n\n## 8. Güvenlik Analizi\n\n### Şifreli Olmayan Trafiği Analiz Etme\n\n**HTTP trafiğinde kullanıcı adı/parola arama:**\n```\nhttp.request.method == \"POST\" && tcp contains \"password\"\n```\n\n**FTP giriş denemelerini bulma:**\n```\nftp.request.command == \"USER\" || ftp.request.command == \"PASS\"\n```\n\n**Telnet trafiğini bulma:**\n```\ntelnet\n```\n\n### Zararlı Trafik Tespiti\n\n**Büyük boyutlu paketler:**\n```\nframe.len > 1500\n```\n\n**Anormal portlar:**\n```\ntcp.port == 4444 || tcp.port == 5555\n```\n\n**ICMP flood tespiti:**\n```\nicmp && frame.time_delta < 0.01\n```\n\n## 9. Best Practices\n\n1. **Gizlilik:** Hassas verileri yakalarken dikkatli olun\n2. **Performans:** Büyük ağlarda filtre kullanın\n3. **Depolama:** Yakalanan dosyaları düzenli aralıklarla temizleyin\n4. **Yetki:** Sadece yetkili olduğunuz ağları izleyin\n5. **Yasal:** Ağ izleme faaliyetlerinin yasallığından emin olun\n\n## 10. Kaynaklar\n\n- Resmi Website: https://www.wireshark.org/\n- Dokümantasyon: https://www.wireshark.org/docs/\n- Örnek PCAP dosyaları: https://wiki.wireshark.org/SampleCaptures",
      "en": "# Wireshark - Network Protocol Analyzer\n\n## 1. Description\nWireshark is an open-source network protocol analyzer that captures and analyzes network protocols in real-time. It allows users to examine network traffic in a user-friendly way with its graphical interface.\n\n## 2. Basic Usage\n\n### Packet Capture\n\n**Capture packets from a specific interface:**\n```\nwireshark -i eth0\n```\n\n**Capture packets from all interfaces:**\n```\nwireshark -i any\n```\n\n**Capture a specific number of packets:**\n```\nwireshark -i eth0 -c 100\n```\n\n**Save packets to a file:**\n```\nwireshark -i eth0 -w capture.pcap\n```\n\n**Open a previously saved file:**\n```\nwireshark capture.pcap\n```\n\n## 3. Display Filters\n\n### Basic Filters\n\n**Specific IP address:**\n```\nip.addr == 192.168.1.100\n```\n\n**Source IP:**\n```\nip.src == 192.168.1.100\n```\n\n**Destination IP:**\n```\nip.dst == 192.168.1.100\n```\n\n**Specific port:**\n```\ntcp.port == 80\n```\n\n**Source port:**\n```\ntcp.srcport == 80\n```\n\n**Destination port:**\n```\ntcp.dstport == 80\n```\n\n**Specific protocol:**\n```\nhttp\n```\n\n**Specific MAC address:**\n```\neth.addr == 00:11:22:33:44:55\n```\n\n### Advanced Filters\n\n**HTTP GET requests:**\n```\nhttp.request.method == \"GET\"\n```\n\n**HTTP POST requests:**\n```\nhttp.request.method == \"POST\"\n```\n\n**Specific URL:**\n```\nhttp.host == \"example.com\"\n```\n\n**DNS queries:**\n```\ndns\n```\n\n**ARP requests:**\n```\narp.opcode == 1\n```\n\n**TCP SYN packets:**\n```\ntcp.flags.syn == 1\n```\n\n**TCP RST packets:**\n```\ntcp.flags.reset == 1\n```\n\n**ICMP packets:**\n```\nicmp\n```\n\n**Packets of specific size:**\n```\nframe.len > 1000\n```\n\n## 4. Capture Filters\n\n### Basic Capture Filters\n\n**Packets from a specific IP address:**\n```\nwireshark -i eth0 host 192.168.1.100\n```\n\n**Packets from a specific network:**\n```\nwireshark -i eth0 net 192.168.1.0/24\n```\n\n**Packets on a specific port:**\n```\nwireshark -i eth0 port 80\n```\n\n**Packets of a specific protocol:**\n```\nwireshark -i eth0 tcp\n```\n\n**Packets in a specific port range:**\n```\nwireshark -i eth0 portrange 80-100\n```\n\n**Packets in a specific direction:**\n```\nwireshark -i eth0 src host 192.168.1.100\nwireshark -i eth0 dst host 192.168.1.100\n```\n\n## 5. Statistical Analysis\n\n### Conversations\n- Accessed from **Statistics > Conversations** menu\n- Shows communication between IPs, TCP, UDP protocols\n- Displays sent/received byte amounts\n\n### Protocol Hierarchy\n- Accessed from **Statistics > Protocol Hierarchy** menu\n- Shows which protocols are used how much\n- Performs protocol-based traffic analysis\n\n### Flow Graph\n- Accessed from **Statistics > Flow Graph** menu\n- Shows TCP connection setup and flow\n- Visualizes 3-way handshake and data flow\n\n## 6. Real-time Analysis\n\n### Follow TCP Stream\n- Used to follow a TCP stream\n- Right-click > Follow > TCP Stream\n- Allows you to see HTTP request/response completely\n\n### Expert Info\n- Accessed from **Analyze > Expert Info** menu\n- Shows abnormal network behavior\n- Lists error, warning and info messages\n\n## 7. Command Line Usage\n\n### tshark (Terminal-based Wireshark)\n\n**Basic usage:**\n```\ntshark -i eth0\n```\n\n**With specific filter:**\n```\ntshark -i eth0 -f \"tcp port 80\"\n```\n\n**With display filter:**\n```\ntshark -i eth0 -R \"http.request.method == GET\"\n```\n\n**Write packets to file:**\n```\ntshark -i eth0 -w capture.pcap\n```\n\n**Read from file:**\n```\ntshark -r capture.pcap\n```\n\n**Extract specific fields:**\n```\ntshark -r capture.pcap -T fields -e ip.src -e ip.dst -e tcp.srcport -e tcp.dstport\n```\n\n## 8. Security Analysis\n\n### Analyzing Unencrypted Traffic\n\n**Searching for username/password in HTTP traffic:**\n```\nhttp.request.method == \"POST\" && tcp contains \"password\"\n```\n\n**Finding FTP login attempts:**\n```\nftp.request.command == \"USER\" || ftp.request.command == \"PASS\"\n```\n\n**Finding Telnet traffic:**\n```\ntelnet\n```\n\n### Malicious Traffic Detection\n\n**Large packets:**\n```\nframe.len > 1500\n```\n\n**Abnormal ports:**\n```\ntcp.port == 4444 || tcp.port == 5555\n```\n\n**ICMP flood detection:**\n```\nicmp && frame.time_delta < 0.01\n```\n\n## 9. Best Practices\n\n1. **Privacy:** Be careful when capturing sensitive data\n2. **Performance:** Use filters on large networks\n3. **Storage:** Clean captured files at regular intervals\n4. **Authorization:** Only monitor networks you are authorized to\n5. **Legal:** Ensure the legality of network monitoring activities\n\n## 10. Resources\n\n- Official Website: https://www.wireshark.org/\n- Documentation: https://www.wireshark.org/docs/\n- Sample PCAP files: https://wiki.wireshark.org/SampleCaptures"
    },
    "tags": [
      "wireshark",
      "network-analysis",
      "packet-capture",
      "pcap",
      "tshark"
    ],
    "links": [
      "https://www.wireshark.org/",
      "https://www.wireshark.org/docs/"
    ],
    "category": { "$oid": "6915e1cc2ee79a06a3d4bc50" }
  },
  {
    "title": {
      "tr": "Nessus Cheatsheet",
      "en": "Nessus Cheatsheet"
    },
    "description": {
      "tr": "# Nessus - Vulnerability Scanner\n\n## 1. Açıklama\nNessus, Tenable tarafından geliştirilen, ağ cihazları, sunucular ve uygulamalar üzerinde güvenlik açıklarını tespit etmek için kullanılan lider sızma testi ve güvenlik denetimi aracıdır.\n\n## 2. Temel Kullanım\n\n### Tarama Türleri\n\n**Basic Network Scan (Temel Ağ Taraması):**\n- Standart port taraması ve hizmet tespiti\n- En yaygın kullanılan tarama türü\n\n**Advanced Network Scan (Gelişmiş Ağ Taraması):**\n- Daha detaylı tarama seçenekleri\n- Zamanlama ve performans ayarları\n\n**Malware Scan (Zararlı Yazılım Taraması):**\n- Sistemdeki zararlı yazılımları tespit eder\n- Rootkit ve backdoor taraması yapar\n\n**SCADA OT Scan (Endüstriyel Sistem Taraması):**\n- SCADA ve OT sistemler için özel tarama\n- Kritik altyapı sistemlerini denetler\n\n### Tarama Oluşturma\n\n1. **New Scan** butonuna tıklayın\n2. Uygun tarama türünü seçin\n3. **Targets** sekmesine hedef IP'leri girin\n4. **Credentials** sekmesine kimlik bilgilerini girin (varsa)\n5. **Schedule** sekmesinde zamanlama ayarlarını yapın\n6. **Save** ile taramayı kaydedin\n7. **Launch** ile taramayı başlatın\n\n## 3. Kimlik Bilgileri ile Tarama\n\n### SSH Kimlik Bilgileri\n\n**Linux sistemler için:**\n- Username: root veya başka bir kullanıcı\n- Password veya SSH key kullanabilirsiniz\n- Sistem dosyalarına erişim sağlar\n\n### Windows Kimlik Bilgileri\n\n**Windows sistemler için:**\n- Username: Administrator veya domain kullanıcı\n- Password: Kullanıcı şifresi\n- WMI ve SMB üzerinden erişim sağlar\n\n### SNMP Kimlik Bilgileri\n\n**Ağ cihazları için:**\n- Community string: public, private vb.\n- Cihaz yapılandırmasını okur\n- Sistem bilgilerini toplar\n\n## 4. Gelişmiş Ayarlar\n\n### Zamanlama Ayarları (Timing)\n\n**Performance Level:**\n- **Slow:** Daha az agresif, IDS/IPS tetiklemez\n- **Normal:** Dengeleme\n- **Fast:** Hızlı tarama, daha gürültülü\n\n### Port Tarama Ayarları\n\n**Port Scan Options:**\n- **TCP:** TCP port taraması\n- **UDP:** UDP port taraması\n- **SYN Scan:** Half-open tarama\n- **Service Detection:** Servis versiyon tespiti\n\n### Plugin Ayarları\n\n**Plugin Selection:**\n- Hangi güvenlik kontrol eklentilerinin çalıştırılacağını seçin\n- Kritik, yüksek, orta, düşük öncelikli eklentiler\n- Özel eklenti grupları\n\n## 5. Raporlama\n\n### Rapor Türleri\n\n**HTML Raporu:**\n- Web tarayıcısında görüntülenebilir\n- Renkli ve detaylı çıktı\n- Yönetici sunumları için uygun\n\n**PDF Raporu:**\n- Yazdırılabilir format\n- Profesyonel görünüm\n- Müşteri sunumları için uygun\n\n**CSV Raporu:**\n- Elektronik tablo uygulamalarında açılabilir\n- Veri analizi için uygun\n- İstatistiksel raporlamalar için\n\n### Filtreleme\n\n**Severity Filtering:**\n- Kritik, Yüksek, Orta, Düşük, Bilgi seviyesinde filtreleme\n- Sadece belirli türde açıkları gösterme\n\n**Plugin Family Filtering:**\n- Belirli eklenti ailelerine göre filtreleme\n- Örn: Web Servers, Windows, Linux\n\n## 6. Command Line Kullanımı (nessuscli)\n\n### Temel Komutlar\n\n**Tarama başlatma:**\n```\nnessuscli scan launch <scan_id>\n```\n\n**Tarama durdurma:**\n```\nnessuscli scan stop <scan_id>\n```\n\n**Tarama listesi:**\n```\nnessuscli scan list\n```\n\n**Tarama detayları:**\n```\nnessuscli scan details <scan_id>\n```\n\n### Yönetici Komutları\n\n**Kullanıcı ekleme:**\n```\nnessuscli adduser <username>\n```\n\n**Lisans yükleme:**\n```\nnessuscli fetch --register <activation_code>\n```\n\n**Servis durumu:**\n```\nnessuscli status\n```\n\n## 7. Güvenlik Açıkları Yönetimi\n\n### Açıkların Sınıflandırılması\n\n**CVSS Skorlaması:**\n- **Kritik (9.0-10.0):** Hemen düzeltilmeli\n- **Yüksek (7.0-8.9):** Kısa sürede düzeltilmeli\n- **Orta (4.0-6.9):** Planlanarak düzeltilmeli\n- **Düşük (0.1-3.9):** İzlenebilir\n\n### False Positive Yönetimi\n\n**Açık doğrulama:**\n- Manuel olarak açık tespitini doğrulayın\n- Alternatif araçlarla teyit edin\n- Uygulama sürümünü kontrol edin\n\n### Düzenli Tarama Planlama\n\n**Otomatik taramalar:**\n- Haftalık veya aylık periyotlarda\n- Kritik sistemler için daha sık\n- Yeni sistemler için hemen\n\n## 8. Best Practices\n\n1. **Kimlik Bilgileri:** Mümkünse taramalarda kimlik bilgisi kullanın\n2. **Zamanlama:** Çalışma saatleri dışında tarama yapın\n3. **Ağ Performansı:** Büyük ağlarda parçalı tarama yapın\n4. **Raporlama:** Düzenli raporlar oluşturun ve saklayın\n5. **Takip:** Açıkların kapanıp kapanmadığını kontrol edin\n\n## 9. Kaynaklar\n\n- Resmi Website: https://www.tenable.com/products/nessus\n- Dokümantasyon: https://docs.tenable.com/Nessus.htm\n- Topluluk Forumu: https://community.tenable.com/s/",
      "en": "# Nessus - Vulnerability Scanner\n\n## 1. Description\nNessus is a leading penetration testing and security auditing tool developed by Tenable for detecting security vulnerabilities on network devices, servers, and applications.\n\n## 2. Basic Usage\n\n### Scan Types\n\n**Basic Network Scan:**\n- Standard port scanning and service detection\n- Most commonly used scan type\n\n**Advanced Network Scan:**\n- More detailed scanning options\n- Timing and performance settings\n\n**Malware Scan:**\n- Detects malware on the system\n- Scans for rootkits and backdoors\n\n**SCADA OT Scan:**\n- Specialized scanning for SCADA and OT systems\n- Audits critical infrastructure systems\n\n### Creating a Scan\n\n1. Click the **New Scan** button\n2. Select the appropriate scan type\n3. Enter target IPs in the **Targets** tab\n4. Enter credentials in the **Credentials** tab (if any)\n5. Set scheduling options in the **Schedule** tab\n6. **Save** the scan\n7. **Launch** the scan\n\n## 3. Credential-based Scanning\n\n### SSH Credentials\n\n**For Linux systems:**\n- Username: root or another user\n- You can use password or SSH key\n- Provides access to system files\n\n### Windows Credentials\n\n**For Windows systems:**\n- Username: Administrator or domain user\n- Password: User password\n- Provides access via WMI and SMB\n\n### SNMP Credentials\n\n**For network devices:**\n- Community string: public, private, etc.\n- Reads device configuration\n- Collects system information\n\n## 4. Advanced Settings\n\n### Timing Settings\n\n**Performance Level:**\n- **Slow:** Less aggressive, doesn't trigger IDS/IPS\n- **Normal:** Balanced\n- **Fast:** Fast scan, more noisy\n\n### Port Scanning Settings\n\n**Port Scan Options:**\n- **TCP:** TCP port scan\n- **UDP:** UDP port scan\n- **SYN Scan:** Half-open scan\n- **Service Detection:** Service version detection\n\n### Plugin Settings\n\n**Plugin Selection:**\n- Select which security check plugins to run\n- Critical, high, medium, low priority plugins\n- Custom plugin groups\n\n## 5. Reporting\n\n### Report Types\n\n**HTML Report:**\n- Viewable in web browser\n- Colorful and detailed output\n- Suitable for executive presentations\n\n**PDF Report:**\n- Printable format\n- Professional appearance\n- Suitable for customer presentations\n\n**CSV Report:**\n- Can be opened in spreadsheet applications\n- Suitable for data analysis\n- For statistical reporting\n\n### Filtering\n\n**Severity Filtering:**\n- Filtering by Critical, High, Medium, Low, Info level\n- Show only specific types of vulnerabilities\n\n**Plugin Family Filtering:**\n- Filtering by specific plugin families\n- E.g.: Web Servers, Windows, Linux\n\n## 6. Command Line Usage (nessuscli)\n\n### Basic Commands\n\n**Launch scan:**\n```\nnessuscli scan launch <scan_id>\n```\n\n**Stop scan:**\n```\nnessuscli scan stop <scan_id>\n```\n\n**List scans:**\n```\nnessuscli scan list\n```\n\n**Scan details:**\n```\nnessuscli scan details <scan_id>\n```\n\n### Admin Commands\n\n**Add user:**\n```\nnessuscli adduser <username>\n```\n\n**Install license:**\n```\nnessuscli fetch --register <activation_code>\n```\n\n**Service status:**\n```\nnessuscli status\n```\n\n## 7. Vulnerability Management\n\n### Vulnerability Classification\n\n**CVSS Scoring:**\n- **Critical (9.0-10.0):** Should be fixed immediately\n- **High (7.0-8.9):** Should be fixed shortly\n- **Medium (4.0-6.9):** Should be fixed as planned\n- **Low (0.1-3.9):** Can be monitored\n\n### False Positive Management\n\n**Vulnerability verification:**\n- Manually verify vulnerability detection\n- Confirm with alternative tools\n- Check application version\n\n### Regular Scan Scheduling\n\n**Automated scans:**\n- Weekly or monthly intervals\n- More frequent for critical systems\n- Immediately for new systems\n\n## 8. Best Practices\n\n1. **Credentials:** Use credentials in scans when possible\n2. **Timing:** Scan outside working hours\n3. **Network Performance:** Use segmented scanning on large networks\n4. **Reporting:** Create and store regular reports\n5. **Tracking:** Check if vulnerabilities are fixed\n\n## 9. Resources\n\n- Official Website: https://www.tenable.com/products/nessus\n- Documentation: https://docs.tenable.com/Nessus.htm\n- Community Forum: https://community.tenable.com/s/"
    },
    "tags": [
      "nessus",
      "vulnerability-scanner",
      "security-audit",
      "penetration-testing",
      "cvss"
    ],
    "links": [
      "https://www.tenable.com/products/nessus",
      "https://docs.tenable.com/Nessus.htm"
    ],
    "category": { "$oid": "6915e1cc2ee79a06a3d4bc59" }
  }
]

// Combine base data with additional tools
const completeData = [...baseData.sheets, ...additionalTools]

// Load current database
const currentData = JSON.parse(fs.readFileSync(path.join(mdbPath, 'cheatsheets.json'), 'utf-8'))

console.log(`Base data: ${baseData.sheets.length} cheatsheets`)
console.log(`Additional tools: ${additionalTools.length} cheatsheets`)
console.log(`Complete set: ${completeData.length} cheatsheets`)
console.log(`Current database: ${currentData.length} cheatsheets`)

// Check for missing tools
const currentTitles = currentData.map(item => item.title.tr || item.title)
const completeTitles = completeData.map(item => item.title.tr || item.title)
const missingTitles = completeTitles.filter(title => !currentTitles.includes(title))

if (missingTitles.length > 0) {
  console.log(`\nMissing cheatsheets (${missingTitles.length}):`)
  missingTitles.forEach((title, index) => {
    console.log(`${index + 1}. ${title}`)
  })
  
  // Add missing tools to database
  const missingTools = completeData.filter(item => 
    missingTitles.includes(item.title.tr || item.title)
  )
  
  const updatedData = [...currentData, ...missingTools]
  fs.writeFileSync(path.join(mdbPath, 'cheatsheets.json'), JSON.stringify(updatedData, null, 2))
  console.log(`\nSuccessfully added ${missingTools.length} missing cheatsheets to database.`)
} else {
  console.log('\nAll cheatsheets are present in the database.')
  console.log('Current database has', currentData.length, 'cheatsheets.')
  
  // Check if we have more than expected (additional tools)
  if (currentData.length > completeData.length) {
    const extraCount = currentData.length - completeData.length
    console.log(`Database contains ${extraCount} additional cheatsheets beyond the expected set.`)
  }
}